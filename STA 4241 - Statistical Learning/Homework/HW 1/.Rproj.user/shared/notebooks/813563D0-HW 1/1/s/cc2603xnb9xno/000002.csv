"0",""
"0","# KNN algorithm with tuning (k = 1, 2, ..., 100)"
"0","# Objective is to determine best value of k and corresponding metrics"
"0","knn_clf_tuned <- train("
"0","  x = train_set,"
"0","  y = train_labels,"
"0","  method = ""knn"","
"0","  metric = ""Accuracy"","
"0","  preProcess = c(""center"",""scale""),"
"0","  tuneGrid = data.frame('k' = c(1:100))"
"0",")"
"0",""
"0","print('Tuned KNN Classifier details:\n')"
"1","[1]"
"1"," ""Tuned KNN Classifier details:\n"""
"1","
"
"0","print(knn_clf_tuned)"
"1","k-Nearest Neighbors"
"1"," "
"1","

"
"1","500"
"1",""
"1"," samples"
"1","
"
"1","  2"
"1",""
"1"," predictor"
"1",""
"1","
"
"1","  2"
"1"," "
"1","classes:"
"1"," "
"1","'0', '1'"
"1"," "
"1","
"
"1","
"
"1","Pre-processing: centered (2), scaled (2)"
"1"," "
"1","
"
"1","Resampling:"
"1"," "
"1","Bootstrapped (25 reps)"
"1"," "
"1","
"
"1","Summary of sample sizes:"
"1"," "
"1","500, 500, 500, 500, 500, 500, ..."
"1"," "
"1","
"
"1","Resampling results"
"1"," across tuning parameters"
"1",":

"
"1",""
"1","  k  "
"1","  Accuracy "
"1","  Kappa    "
"1","
"
"1","    1"
"1","  0.5644792"
"1","  0.1285321"
"1","
"
"1","    2"
"1","  0.5670818"
"1","  0.1351507"
"1","
"
"1","    3"
"1","  0.5762374"
"1","  0.1531488"
"1","
"
"1","    4"
"1","  0.5764411"
"1","  0.1532891"
"1","
"
"1","    5"
"1","  0.5876717"
"1","  0.1756566"
"1","
"
"1","    6"
"1","  0.5874703"
"1","  0.1770602"
"1","
"
"1","    7"
"1","  0.5910628"
"1","  0.1838469"
"1","
"
"1","    8"
"1","  0.5923628"
"1","  0.1860804"
"1","
"
"1","    9"
"1","  0.5897465"
"1","  0.1805339"
"1","
"
"1","   10"
"1","  0.5978397"
"1","  0.1962067"
"1","
"
"1","   11"
"1","  0.5989099"
"1","  0.1978623"
"1","
"
"1","   12"
"1","  0.5982620"
"1","  0.1969797"
"1","
"
"1","   13"
"1","  0.5990432"
"1","  0.1986567"
"1","
"
"1","   14"
"1","  0.6014980"
"1","  0.2037808"
"1","
"
"1","   15"
"1","  0.6050124"
"1","  0.2104746"
"1","
"
"1","   16"
"1","  0.6129330"
"1","  0.2263023"
"1","
"
"1","   17"
"1","  0.6213101"
"1","  0.2430953"
"1","
"
"1","   18"
"1","  0.6188441"
"1","  0.2376564"
"1","
"
"1","   19"
"1","  0.6253451"
"1","  0.2506167"
"1","
"
"1","   20"
"1","  0.6201163"
"1","  0.2405861"
"1","
"
"1","   21"
"1","  0.6217354"
"1","  0.2432851"
"1","
"
"1","   22"
"1","  0.6177179"
"1","  0.2361635"
"1","
"
"1","   23"
"1","  0.6232821"
"1","  0.2470881"
"1","
"
"1","   24"
"1","  0.6257991"
"1","  0.2519538"
"1","
"
"1","   25"
"1","  0.6243416"
"1","  0.2489678"
"1","
"
"1","   26"
"1","  0.6240101"
"1","  0.2486613"
"1","
"
"1","   27"
"1","  0.6265950"
"1","  0.2536824"
"1","
"
"1","   28"
"1","  0.6222923"
"1","  0.2456333"
"1","
"
"1","   29"
"1","  0.6234655"
"1","  0.2477571"
"1","
"
"1","   30"
"1","  0.6260609"
"1","  0.2526580"
"1","
"
"1","   31"
"1","  0.6245169"
"1","  0.2498233"
"1","
"
"1","   32"
"1","  0.6244949"
"1","  0.2497791"
"1","
"
"1","   33"
"1","  0.6248981"
"1","  0.2503309"
"1","
"
"1","   34"
"1","  0.6281326"
"1","  0.2563727"
"1","
"
"1","   35"
"1","  0.6255412"
"1","  0.2510103"
"1","
"
"1","   36"
"1","  0.6271283"
"1","  0.2541539"
"1","
"
"1","   37"
"1","  0.6301779"
"1","  0.2600376"
"1","
"
"1","   38"
"1","  0.6292974"
"1","  0.2582621"
"1","
"
"1","   39"
"1","  0.6274774"
"1","  0.2550710"
"1","
"
"1","   40"
"1","  0.6281010"
"1","  0.2560325"
"1","
"
"1","   41"
"1","  0.6235375"
"1","  0.2472472"
"1","
"
"1","   42"
"1","  0.6259569"
"1","  0.2520783"
"1","
"
"1","   43"
"1","  0.6275711"
"1","  0.2549768"
"1","
"
"1","   44"
"1","  0.6316432"
"1","  0.2627010"
"1","
"
"1","   45"
"1","  0.6307706"
"1","  0.2610168"
"1","
"
"1","   46"
"1","  0.6348788"
"1","  0.2691228"
"1","
"
"1","   47"
"1","  0.6307062"
"1","  0.2610992"
"1","
"
"1","   48"
"1","  0.6385896"
"1","  0.2766867"
"1","
"
"1","   49"
"1","  0.6391211"
"1","  0.2780908"
"1","
"
"1","   50"
"1","  0.6410956"
"1","  0.2820706"
"1","
"
"1","   51"
"1","  0.6424726"
"1","  0.2845666"
"1","
"
"1","   52"
"1","  0.6419205"
"1","  0.2834082"
"1","
"
"1","   53"
"1","  0.6433586"
"1","  0.2859859"
"1","
"
"1","   54"
"1","  0.6414183"
"1","  0.2821474"
"1","
"
"1","   55"
"1","  0.6451982"
"1","  0.2895434"
"1","
"
"1","   56"
"1","  0.6432303"
"1","  0.2856550"
"1","
"
"1","   57"
"1","  0.6434980"
"1","  0.2859387"
"1","
"
"1","   58"
"1","  0.6438362"
"1","  0.2868934"
"1","
"
"1","   59"
"1","  0.6415940"
"1","  0.2827212"
"1","
"
"1","   60"
"1","  0.6412450"
"1","  0.2819644"
"1","
"
"1","   61"
"1","  0.6408895"
"1","  0.2808669"
"1","
"
"1","   62"
"1","  0.6419203"
"1","  0.2828363"
"1","
"
"1","   63"
"1","  0.6427841"
"1","  0.2845698"
"1","
"
"1","   64"
"1","  0.6419915"
"1","  0.2830572"
"1","
"
"1","   65"
"1","  0.6399622"
"1","  0.2790368"
"1","
"
"1","   66"
"1","  0.6409761"
"1","  0.2812034"
"1","
"
"1","   67"
"1","  0.6453094"
"1","  0.2896217"
"1","
"
"1","   68"
"1","  0.6450092"
"1","  0.2893344"
"1","
"
"1","   69"
"1","  0.6460201"
"1","  0.2912638"
"1","
"
"1","   70"
"1","  0.6421209"
"1","  0.2837209"
"1","
"
"1","   71"
"1","  0.6421152"
"1","  0.2834915"
"1","
"
"1","   72"
"1","  0.6416614"
"1","  0.2825403"
"1","
"
"1","   73"
"1","  0.6422099"
"1","  0.2832131"
"1","
"
"1","   74"
"1","  0.6424638"
"1","  0.2839912"
"1","
"
"1","   75"
"1","  0.6426857"
"1","  0.2844500"
"1","
"
"1","   76"
"1","  0.6439183"
"1","  0.2874773"
"1","
"
"1","   77"
"1","  0.6417189"
"1","  0.2832566"
"1","
"
"1","   78"
"1","  0.6440067"
"1","  0.2875654"
"1","
"
"1","   79"
"1","  0.6436760"
"1","  0.2871082"
"1","
"
"1","   80"
"1","  0.6446503"
"1","  0.2888095"
"1","
"
"1","   81"
"1","  0.6424041"
"1","  0.2843678"
"1","
"
"1","   82"
"1","  0.6391166"
"1","  0.2777008"
"1","
"
"1","   83"
"1","  0.6410422"
"1","  0.2814757"
"1","
"
"1","   84"
"1","  0.6376668"
"1","  0.2748376"
"1","
"
"1","   85"
"1","  0.6405511"
"1","  0.2807620"
"1","
"
"1","   86"
"1","  0.6405117"
"1","  0.2805430"
"1","
"
"1","   87"
"1","  0.6412754"
"1","  0.2819061"
"1","
"
"1","   88"
"1","  0.6397240"
"1","  0.2788496"
"1","
"
"1","   89"
"1","  0.6411738"
"1","  0.2819569"
"1","
"
"1","   90"
"1","  0.6371462"
"1","  0.2734805"
"1","
"
"1","   91"
"1","  0.6389128"
"1","  0.2770520"
"1","
"
"1","   92"
"1","  0.6381449"
"1","  0.2757524"
"1","
"
"1","   93"
"1","  0.6374966"
"1","  0.2741455"
"1","
"
"1","   94"
"1","  0.6392491"
"1","  0.2777865"
"1","
"
"1","   95"
"1","  0.6410009"
"1","  0.2813325"
"1","
"
"1","   96"
"1","  0.6408444"
"1","  0.2808903"
"1","
"
"1","   97"
"1","  0.6414261"
"1","  0.2823578"
"1","
"
"1","   98"
"1","  0.6414496"
"1","  0.2820740"
"1","
"
"1","   99"
"1","  0.6427456"
"1","  0.2846462"
"1","
"
"1","  100"
"1","  0.6406893"
"1","  0.2806947"
"1","
"
"1","
"
"1","Accuracy was used to select the optimal model using the largest value.
"
"1","The final value used for the model was k = 69."
"1","
"
"0","cat('\nTrain set:\n')"
"1","
Train set:
"
"0","overall_ber_clf(clf = knn_clf_tuned, X = train_set, y = train_labels)"
"1","
Predicted labels:
"
"1"," "
"1","2"
"1"," "
"1","1"
"1"," "
"1","1"
"1"," "
"1","1"
"1"," "
"1","2"
"1"," "
"1","1"
"1","[1]"
"1"," ""\nConfusion matrix:\n"""
"1","
"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","   0"
"1","   1"
"1","
         0"
"1"," 190"
"1","  98"
"1","
         1"
"1","  69"
"1"," 143"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.666           "
"1","
"
"1","                 95% CI :"
"1"," (0.6228, 0.7073)"
"1","
"
"1","    No Information Rate :"
"1"," 0.518           "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 1.464e-11       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.3283          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," 0.03026         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.7336          "
"1","
"
"1","            Specificity :"
"1"," 0.5934          "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.6597          "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.6745          "
"1","
"
"1","             Prevalence :"
"1"," 0.5180          "
"1","
"
"1","         Detection Rate :"
"1"," 0.3800          "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.5760          "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.6635          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," 0               "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","
Accuracy:
"
"1"," "
"1","0.666"
"1","
Overall Bayes error rate:
"
"1"," "
"1","0.334"
"1","[1]"
"1"," 0.334"
"1","
"
"0","cat('\nTest set:\n')"
"1","
Test set:
"
"0","overall_ber_clf(clf = knn_clf_tuned, X = test_set, y = test_labels)"
"1","
Predicted labels:
"
"1"," "
"1","1"
"1"," "
"1","1"
"1"," "
"1","2"
"1"," "
"1","2"
"1"," "
"1","2"
"1"," "
"1","1"
"1","[1]"
"1"," ""\nConfusion matrix:\n"""
"1","
"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","   0"
"1","   1"
"1","
         0"
"1"," 186"
"1"," 101"
"1","
         1"
"1","  63"
"1"," 150"
"1","
"
"1",""
"1","                         "
"1","                "
"1","
"
"1","               Accuracy :"
"1"," 0.672          "
"1","
"
"1","                 95% CI :"
"1"," (0.6289, 0.713)"
"1","
"
"1","    No Information Rate :"
"1"," 0.502          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 1.126e-14      "
"1","
"
"1","                         "
"1","                "
"1","
"
"1","                  Kappa :"
"1"," 0.3444         "
"1","
"
"1","                         "
"1","                "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," 0.003862       "
"1","
"
"1","                         "
"1","                "
"1","
"
"1","            Sensitivity :"
"1"," 0.7470         "
"1","
"
"1","            Specificity :"
"1"," 0.5976         "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.6481         "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.7042         "
"1","
"
"1","             Prevalence :"
"1"," 0.4980         "
"1","
"
"1","         Detection Rate :"
"1"," 0.3720         "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.5740         "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.6723         "
"1","
"
"1","                         "
"1","                "
"1","
"
"1","       'Positive' Class :"
"1"," 0              "
"1","
"
"1","                         "
"1","                "
"1","
"
"1","
Accuracy:
"
"1"," "
"1","0.672"
"1","
Overall Bayes error rate:
"
"1"," "
"1","0.328"
"1","[1]"
"1"," 0.328"
"1","
"
